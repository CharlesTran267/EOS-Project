{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\EOS Project\\\\front-end\\\\src\\\\app\\\\search\\\\Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { IconButton, Typography } from '@material-ui/core';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { useStyles } from './Search.styles';\nimport { useHistory } from 'react-router-dom';\nimport VolcanoCard from './volcanoCard';\nimport Tags from '../../components/Tags.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst originalTags = ['Volcano Name', 'Silica Content', 'TAS', 'Eruptive Style', 'Particle Type', 'Glassy Type', 'Crystallinity', 'Aleration', 'Shape'];\n\nfunction Search() {\n  _s();\n\n  const classes = useStyles();\n  const history = useHistory();\n  const [tags, setTags] = useState(originalTags);\n  const [selectedTags, setSelectedTags] = useState([]);\n  const [fetchedData, setFetchedData] = useState({});\n  const [searchFilter, setSearchFilter] = useState(\"\");\n  const [particles, setParticles] = useState([]);\n  const [volcanoes, setVolcanoes] = useState([]);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [searchData, setSearchData] = useState({});\n  const [searchSubmit, setSearchSubmit] = useState(\"\");\n  const [buttonClicked, setButtonClicked] = useState(false);\n  const [searched, setSearched] = useState(false);\n\n  const handleChange = event => {\n    const value = event.target.value;\n    setSearchTerm(value);\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setSearched(true);\n    setSearchSubmit(searchTerm);\n    setButtonClicked(true);\n  };\n\n  useEffect(() => {\n    axios.get(\"/volcanoes/getVolcanoes\").then(response => {\n      if (response.data.success) {\n        setVolcanoes(response.data.volcanoes);\n      } else {\n        alert(\"Failed to fetch data\");\n      }\n    });\n    axios.get(\"/volcanoes/getParticles\").then(response => {\n      if (response.data.success) {\n        setParticles(response.data.particles);\n      } else {\n        alert(\"Failed to fetch data\");\n      }\n    });\n  }, []);\n  useEffect(() => {\n    setFetchedData({\n      Volcanoes: volcanoes,\n      Particles: particles\n    });\n  }, [particles]);\n  useEffect(() => {\n    if (searchSubmit !== \"\" || selectedTags.length !== 0) {\n      const dataList = {};\n      var filter = [...selectedTags];\n      filter = filter.join(\" \").toLowerCase().split(\" \");\n      if (searchSubmit && !filter.includes(searchSubmit)) filter.push(searchSubmit);\n      var newSearchfilter = [...filter];\n\n      for (var i = 0; i < newSearchfilter.length; i++) if (newSearchfilter[i]) newSearchfilter[i] = newSearchfilter[i][0].toUpperCase() + newSearchfilter[i].slice(1);\n\n      selectedTags.length ? setSearchFilter(newSearchfilter.join(', ')) : setSearchFilter(searchSubmit[0].toUpperCase() + searchSubmit.slice(1));\n      Object.keys(fetchedData).map(key => {\n        const data = fetchedData[key].filter(d => {\n          var props_arr = Object.values(d).join(\" \").toLowerCase().split(\" \");\n          return filter.every(elem => props_arr.includes(elem));\n        });\n        dataList[key] = data;\n      });\n      setSearchData(dataList);\n    }\n\n    setButtonClicked(false);\n  }, [buttonClicked]);\n\n  const handleKeyPress = event => {\n    if (event.key === 'Enter') {\n      document.getElementById('search-button').click();\n    }\n  };\n\n  const Loading = () => {\n    if (buttonClicked) {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        style: {\n          display: \"block\",\n          marginLeft: \"auto\",\n          marginRight: \"auto\"\n        },\n        src: \"https://cutewallpaper.org/21/loading-gif-transparent-background/All-Loading-Gif-Image-Transparent-Background-Best-Studio-.gif\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 14\n      }, this);\n    }\n\n    return null;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.SearchContainer,\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      className: classes.SearchTitle,\n      children: \"Explore our DataBase\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.SearchBoxContainer,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        className: classes.SearchBox,\n        onChange: handleChange,\n        placeholder: \"Search by Volcano Name, Particle Type or use our Tags\",\n        onKeyDown: handleKeyPress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        type: \"submit\",\n        id: \"search-button\",\n        className: classes.iconButton,\n        \"aria-label\": \"search\",\n        onClick: e => handleSubmit(e),\n        children: /*#__PURE__*/_jsxDEV(SearchIcon, {\n          fontSize: \"large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Tags, {\n      selectedTags: selectedTags,\n      setSelectedTags: setSelectedTags,\n      tags: tags,\n      setTags: setTags\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), searched ? /*#__PURE__*/_jsxDEV(Typography, {\n      style: {\n        marginLeft: 25,\n        paddingBottom: 20\n      },\n      children: searchData.Volcanoes && searchData.Volcanoes.length != 0 || searchData.Particles && searchData.Particles.length != 0 ? /*#__PURE__*/_jsxDEV(Typography, {\n        component: \"h3\",\n        variant: \"h5\",\n        align: \"center\",\n        style: {\n          marginBottom: 10\n        },\n        children: [\"Search results for \\\"\", searchFilter, \"\\\":\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 15\n      }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n        component: \"h3\",\n        variant: \"h5\",\n        align: \"center\",\n        style: {\n          marginBottom: 10\n        },\n        children: [\"Sorry! There is no result for \\\"\", searchFilter, \"\\\" in our database.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/contribute\",\n          style: {\n            textDecoration: \"underline\"\n          },\n          children: \"Help us expand our DataBase!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"hr\", {\n      style: {\n        marginLeft: 25,\n        marginRight: 25,\n        width: \"50%\",\n        border: \"1px solid #C0C0C0\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.ResultContainer,\n      children: [/*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this), searched ? searchData && Object.keys(searchData).map(key => key == \"Volcanoes\" ? searchData[key].length != 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            fontWeight: 700,\n            fontSize: \"30px\",\n            marginBottom: \"10px\"\n          },\n          children: \"Volcano: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            flexDirection: \"row\",\n            flexWrap: \"wrap\"\n          },\n          children: searchData[key].map(ele => /*#__PURE__*/_jsxDEV(VolcanoCard, {\n            info: ele,\n            type: key\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }, this) : null : searchData[key].length != 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            fontWeight: 700,\n            fontSize: \"30px\",\n            marginBottom: \"10px\"\n          },\n          children: \"Particle: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            flexDirection: \"row\",\n            flexWrap: \"wrap\"\n          },\n          children: searchData[key].map(ele => /*#__PURE__*/_jsxDEV(VolcanoCard, {\n            info: ele,\n            type: key\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }, this) : null) : fetchedData && Object.keys(fetchedData).map(key => key == \"Volcanoes\" ? fetchedData[key].length != 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            fontWeight: 700,\n            fontSize: \"30px\",\n            marginBottom: \"10px\"\n          },\n          children: \"Volcano: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(VolcanoCard, {\n          info: fetchedData[key][1],\n          type: key\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 13\n      }, this) : null : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            fontWeight: 700,\n            fontSize: \"30px\",\n            marginBottom: \"10px\"\n          },\n          children: \"Particle: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            flexDirection: \"row\",\n            flexWrap: \"wrap\"\n          },\n          children: fetchedData[key].map(ele => ele.volc_id == 2 ? /*#__PURE__*/_jsxDEV(VolcanoCard, {\n            info: ele,\n            type: key\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this) : null)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Search, \"yyJ6Y5c/ztvr4hFuCyLGjXgr++w=\", false, function () {\n  return [useStyles, useHistory];\n});\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/Users/User/Desktop/EOS Project/front-end/src/app/search/Search.js"],"names":["React","useState","useEffect","axios","IconButton","Typography","SearchIcon","useStyles","useHistory","VolcanoCard","Tags","originalTags","Search","classes","history","tags","setTags","selectedTags","setSelectedTags","fetchedData","setFetchedData","searchFilter","setSearchFilter","particles","setParticles","volcanoes","setVolcanoes","searchTerm","setSearchTerm","searchData","setSearchData","searchSubmit","setSearchSubmit","buttonClicked","setButtonClicked","searched","setSearched","handleChange","event","value","target","handleSubmit","e","preventDefault","get","then","response","data","success","alert","Volcanoes","Particles","length","dataList","filter","join","toLowerCase","split","includes","push","newSearchfilter","i","toUpperCase","slice","Object","keys","map","key","d","props_arr","values","every","elem","handleKeyPress","document","getElementById","click","Loading","display","marginLeft","marginRight","SearchContainer","SearchTitle","SearchBoxContainer","SearchBox","iconButton","paddingBottom","marginBottom","textDecoration","width","border","ResultContainer","fontWeight","fontSize","flexDirection","flexWrap","ele","volc_id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport {\n  IconButton,\n  Typography,\n} from '@material-ui/core';\nimport SearchIcon from '@material-ui/icons/Search';\nimport { useStyles } from './Search.styles';\nimport { useHistory } from 'react-router-dom';\nimport VolcanoCard from './volcanoCard';\nimport Tags from '../../components/Tags.js';\nconst originalTags=['Volcano Name','Silica Content','TAS','Eruptive Style','Particle Type','Glassy Type','Crystallinity','Aleration','Shape']\nfunction Search() {\n  const classes = useStyles();\n  const history = useHistory();\n  const [tags,setTags] = useState(originalTags)\n  const [selectedTags,setSelectedTags] = useState([]);\n  const [fetchedData, setFetchedData] = useState({})\n  const [searchFilter,setSearchFilter] = useState(\"\")\n  const [particles,setParticles] = useState([]);\n  const [volcanoes,setVolcanoes] = useState([])\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [searchData, setSearchData] = useState({});\n  const [searchSubmit,setSearchSubmit] = useState(\"\");\n  const [buttonClicked, setButtonClicked] = useState(false);\n  const [searched, setSearched] = useState(false);\n    const handleChange = (event) => {\n    const value = event.target.value;\n    setSearchTerm(value);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setSearched(true)\n    setSearchSubmit(searchTerm);\n    setButtonClicked(true);\n    };\n  useEffect(()=>{\n     axios.get(\"/volcanoes/getVolcanoes\")\n      .then(response => {\n        if(response.data.success){\n          setVolcanoes(response.data.volcanoes)\n        } else{\n          alert(\"Failed to fetch data\")\n        }\n      })\n     axios.get(\"/volcanoes/getParticles\")\n    .then(response => {\n      if(response.data.success){\n        setParticles(response.data.particles)\n      } else{\n        alert(\"Failed to fetch data\")\n      }\n    })\n\n  },[])\n  useEffect(()=>{\n    setFetchedData({\n      Volcanoes: volcanoes,\n      Particles: particles\n    })\n  },[particles])\n  useEffect(()=>{\n    if (searchSubmit !== \"\" || selectedTags.length!==0) {\n      const dataList  = {} \n      var filter = [...selectedTags];\n      filter = filter.join(\" \").toLowerCase().split(\" \")\n      if (searchSubmit && !filter.includes(searchSubmit)) filter.push(searchSubmit);\n      var newSearchfilter = [...filter]\n      for(var i=0;i<newSearchfilter.length;i++) if(newSearchfilter[i]) newSearchfilter[i]=newSearchfilter[i][0].toUpperCase()+newSearchfilter[i].slice(1);\n      selectedTags.length?setSearchFilter(newSearchfilter.join(', ')):setSearchFilter(searchSubmit[0].toUpperCase()+searchSubmit.slice(1))\n      Object.keys(fetchedData).map(key => {\n        const data = fetchedData[key].filter(d=>{\n          var props_arr = Object.values(d)\n            .join(\" \")\n            .toLowerCase()\n            .split(\" \")\n          return(filter.every(elem => props_arr.includes(elem)))\n        })\n        dataList[key]=data;\n      })\n      setSearchData(dataList);\n    }\n    setButtonClicked(false);\n  },[buttonClicked])\n    const handleKeyPress =(event)=>{\n    if(event.key === 'Enter'){\n      document.getElementById('search-button').click();\n    }\n  }\n  const Loading = () =>{\n    if(buttonClicked){\n      return <img style={{display:\"block\",marginLeft:\"auto\",marginRight:\"auto\"}} src=\"https://cutewallpaper.org/21/loading-gif-transparent-background/All-Loading-Gif-Image-Transparent-Background-Best-Studio-.gif\"/>\n    }\n    return null;\n  }\n  return (\n    <div className={classes.SearchContainer}>\n      <Typography\n        className={classes.SearchTitle}\n      >\n        Explore our DataBase\n      </Typography>\n      <div className={classes.SearchBoxContainer}>\n      <input\n        className={classes.SearchBox}\n        onChange={handleChange}\n        placeholder=\"Search by Volcano Name, Particle Type or use our Tags\"\n        onKeyDown={handleKeyPress}\n      ></input>\n      <IconButton\n        type='submit'\n        id = 'search-button'\n        className={classes.iconButton}\n        aria-label='search'\n        onClick={(e)=>handleSubmit(e)}\n      >\n        <SearchIcon fontSize=\"large\"/>\n      </IconButton>\n      </div>\n      <Tags\n        selectedTags={selectedTags}\n        setSelectedTags={setSelectedTags}\n        tags={tags}\n        setTags={setTags}\n      />\n      {searched?(\n        <Typography style={{ marginLeft: 25, paddingBottom: 20 }}>\n          {(searchData.Volcanoes && searchData.Volcanoes.length!=0) || (searchData.Particles && searchData.Particles.length!=0)? (\n              <Typography\n                component='h3'\n                variant='h5'\n                align='center'\n                style={{ marginBottom: 10 }}\n              >\n                Search results for \"{searchFilter}\":\n              </Typography>\n          ) : (\n            <Typography\n                component='h3'\n                variant='h5'\n                align='center'\n                style={{ marginBottom: 10 }}\n              >\n                Sorry! There is no result for \"{searchFilter}\" in our database.\n                <br/>\n                <a href=\"/contribute\" style={{textDecoration:\"underline\"}}>Help us expand our DataBase!</a>\n              </Typography>\n          )}\n        \n        </Typography>\n      ):null}\n      <hr\n        style={{\n          marginLeft: 25,\n          marginRight: 25,\n          width: \"50%\",\n          border: \"1px solid #C0C0C0\"\n          \n        }}/>\n      <div className={classes.ResultContainer}>\n        <Loading/>\n      {searched?\n        (searchData && Object.keys(searchData).map((key)=>\n            key==\"Volcanoes\"?(searchData[key].length !=0?\n            <div>\n            <h2 style={{fontWeight:700, fontSize: \"30px\", marginBottom:\"10px\"}}>Volcano: </h2>\n            <div style={{display: \"flex\",flexDirection:\"row\",flexWrap:\"wrap\"}}>\n            {searchData[key].map((ele)=>\n            <VolcanoCard\n              info={ele}\n              type={key}\n            />)}\n            </div></div>:null):(\n            searchData[key].length!=0?\n            <div>\n            <h2 style={{fontWeight:700, fontSize: \"30px\", marginBottom:\"10px\"}}>Particle: </h2>\n            <div style={{display: \"flex\",flexDirection:\"row\",flexWrap:\"wrap\"}}>\n            {searchData[key].map((ele)=>\n            <VolcanoCard\n              info={ele}\n              type={key}\n            />)}\n            </div></div>:null)\n            \n        ))\n          :(fetchedData && Object.keys(fetchedData).map((key)=>\n          key==\"Volcanoes\"?(fetchedData[key].length !=0?(\n            <div>\n            <h2 style={{fontWeight:700, fontSize: \"30px\", marginBottom:\"10px\"}}>Volcano: </h2>\n            <VolcanoCard\n              info={fetchedData[key][1]}\n              type={key}\n            />)\n            </div>):null):(\n            <div>\n            <h2 style={{fontWeight:700, fontSize: \"30px\", marginBottom:\"10px\"}}>Particle: </h2>\n            <div style={{display: \"flex\",flexDirection:\"row\",flexWrap:\"wrap\"}}>\n            {fetchedData[key].map((ele)=>\n            ele.volc_id==2?\n            <VolcanoCard\n              info={ele}\n              type={key}\n            />:null)}\n            </div></div>)\n          \n      ))}\n      </div>\n    </div>\n  );\n}\nexport default Search;\n"]},"metadata":{},"sourceType":"module"}